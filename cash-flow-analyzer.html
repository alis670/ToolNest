<!-- cash-flow-analyzer.html -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cash Flow Analyzer</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 min-h-screen p-4 flex justify-center items-start">

<div class="bg-white/10 backdrop-blur rounded-xl p-6 shadow-lg w-full max-w-3xl text-white">
  <h1 class="text-2xl font-bold mb-4 text-center">Cash Flow Analyzer</h1>

  <!-- Add Transaction -->
  <div class="grid gap-2 mb-4 md:grid-cols-2">
    <input type="text" id="desc" placeholder="Description" class="p-2 rounded bg-white/30 text-white placeholder-white">
    <input type="number" id="amount" placeholder="Amount" class="p-2 rounded bg-white/30 text-white placeholder-white">
    <select id="type" class="p-2 rounded bg-white/30 text-white">
      <option value="">Select Type</option>
      <option value="inflow">Inflow (Income)</option>
      <option value="outflow">Outflow (Expense)</option>
    </select>
    <input type="date" id="date" class="p-2 rounded bg-white/30 text-white">
  </div>

  <button id="addBtn" class="w-full bg-indigo-600 py-2 rounded font-semibold hover:bg-indigo-700 mb-4">Add Transaction</button>

  <!-- Transactions Table -->
  <div class="overflow-x-auto mb-4">
    <table class="w-full text-white text-left border-collapse">
      <thead>
        <tr>
          <th class="border-b px-2 py-1">Date</th>
          <th class="border-b px-2 py-1">Type</th>
          <th class="border-b px-2 py-1">Description</th>
          <th class="border-b px-2 py-1">Amount</th>
        </tr>
      </thead>
      <tbody id="tableBody"></tbody>
    </table>
  </div>

  <!-- Net Cash Flow -->
  <div class="mb-4 text-center">
    <h2 class="text-xl font-semibold">Net Cash Flow: <span id="netCash">0</span></h2>
  </div>

  <!-- Chart -->
  <canvas id="cashFlowChart" class="mb-4 bg-white/10 rounded-lg p-2"></canvas>

  <button id="backBtn" class="w-full bg-purple-600 py-2 rounded font-semibold hover:bg-purple-700">Back to Dashboard</button>
</div>

<script>
const descInput = document.getElementById('desc');
const amountInput = document.getElementById('amount');
const typeInput = document.getElementById('type');
const dateInput = document.getElementById('date');
const addBtn = document.getElementById('addBtn');
const tableBody = document.getElementById('tableBody');
const netCashEl = document.getElementById('netCash');
const backBtn = document.getElementById('backBtn');

let transactions = JSON.parse(localStorage.getItem('transactions')) || [];

function renderTransactions() {
  tableBody.innerHTML = "";
  let netCash = 0;
  const monthlyData = {};

  transactions.forEach(tx => {
    const row = document.createElement('tr');
    row.innerHTML = `<td class="border-b px-2 py-1">${tx.date}</td>
                     <td class="border-b px-2 py-1">${tx.type}</td>
                     <td class="border-b px-2 py-1">${tx.desc}</td>
                     <td class="border-b px-2 py-1">${tx.amount}</td>`;
    tableBody.appendChild(row);

    if(tx.type === "inflow") netCash += parseFloat(tx.amount);
    else netCash -= parseFloat(tx.amount);

    const month = tx.date.substring(0,7); // YYYY-MM
    if(!monthlyData[month]) monthlyData[month] = 0;
    monthlyData[month] += (tx.type==="inflow"?1:-1)*parseFloat(tx.amount);
  });

  netCashEl.innerText = netCash.toFixed(2);
  renderChart(monthlyData);
}

function renderChart(data){
  const ctx = document.getElementById('cashFlowChart').getContext('2d');
  if(window.cashFlowChartInstance) window.cashFlowChartInstance.destroy();
  window.cashFlowChartInstance = new Chart(ctx,{
    type:'line',
    data:{
      labels: Object.keys(data),
      datasets:[{
        label: 'Net Cash Flow',
        data: Object.values(data),
        fill: false,
        borderColor: '#10B981',
        tension: 0.3
      }]
    },
    options:{ responsive:true }
  });
}

addBtn.addEventListener('click', ()=>{
  const desc = descInput.value.trim();
  const amount = parseFloat(amountInput.value);
  const type = typeInput.value;
  const date = dateInput.value;

  if(!desc || !amount || !type || !date){
    alert("Please fill all fields correctly.");
    return;
  }

  transactions.push({desc, amount, type, date});
  localStorage.setItem('transactions', JSON.stringify(transactions));
  descInput.value = amountInput.value = typeInput.value = dateInput.value = "";
  renderTransactions();
});

backBtn.addEventListener('click', ()=>window.location.href='index.html');

// Initial render
renderTransactions();
</script>
</body>
</html>
