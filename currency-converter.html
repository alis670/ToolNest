<!-- currency-converter.html -->
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Currency Converter</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 min-h-screen flex justify-center items-start p-4">

<div class="bg-white/10 backdrop-blur rounded-xl p-6 shadow-lg w-full max-w-md text-white">
  <h1 class="text-2xl font-bold mb-4 text-center">Currency Converter</h1>

  <div class="grid gap-2 mb-4 md:grid-cols-2">
    <input type="number" id="amount" placeholder="Amount" class="p-2 rounded bg-white/30 text-white placeholder-white">
    <select id="fromCurrency" class="p-2 rounded bg-white/30 text-white"></select>
    <select id="toCurrency" class="p-2 rounded bg-white/30 text-white md:col-span-2"></select>
  </div>

  <button id="convertBtn" class="w-full bg-indigo-600 py-2 rounded font-semibold hover:bg-indigo-700 mb-4">Convert</button>

  <div id="result" class="text-center text-xl font-semibold"></div>

  <button id="backBtn" class="w-full bg-purple-600 py-2 rounded font-semibold hover:bg-purple-700 mt-4">Back to Dashboard</button>
</div>

<script>
const amountEl = document.getElementById('amount');
const fromEl = document.getElementById('fromCurrency');
const toEl = document.getElementById('toCurrency');
const convertBtn = document.getElementById('convertBtn');
const resultEl = document.getElementById('result');
const backBtn = document.getElementById('backBtn');

// Fetch all currencies from API
async function loadCurrencies() {
  try {
    const res = await fetch('https://open.er-api.com/v6/latest/USD'); // Base currency for rates
    if(!res.ok) throw new Error("Failed to fetch currencies");
    const data = await res.json();
    const currencies = Object.keys(data.rates).sort();

    currencies.forEach(cur => {
      const option1 = document.createElement('option');
      option1.value = cur;
      option1.innerText = cur;
      fromEl.appendChild(option1);

      const option2 = document.createElement('option');
      option2.value = cur;
      option2.innerText = cur;
      toEl.appendChild(option2);
    });

    fromEl.value = "USD"; // default
    toEl.value = "EUR"; // default
  } catch(err) {
    resultEl.innerText = "Error loading currencies: " + err.message;
  }
}

loadCurrencies();

convertBtn.addEventListener('click', async () => {
  const amount = parseFloat(amountEl.value);
  const from = fromEl.value;
  const to = toEl.value;

  if(isNaN(amount)) return alert("Enter valid amount");

  try {
    const res = await fetch(`https://open.er-api.com/v6/latest/${from}`);
    if(!res.ok) throw new Error("Failed to fetch exchange rates");
    const data = await res.json();
    const rate = data.rates[to];
    if(!rate) throw new Error(`Rate for ${to} not found`);

    const converted = (amount * rate).toFixed(2);
    resultEl.innerText = `${amount} ${from} = ${converted} ${to}`;
  } catch (err) {
    resultEl.innerText = "Error: " + err.message;
  }
});

backBtn.addEventListener('click', ()=>window.location.href='index.html');
</script>
</body>
</html>
