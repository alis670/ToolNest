<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ToolNest â€” Dashboard (Premium)</title>

<!-- Tailwind CDN for utility classes -->
<script src="https://cdn.tailwindcss.com"></script>

<style>
  /* Luxury Black â†’ Gold Animated Gradient + Particles */
  :root{
    --gold:#f6c85f;
    --gold-deep:#d4a94a;
    --bg-dark:#07070a;
    --card-bg: rgba(255,255,255,0.03);
  }
  html,body{height:100%}
  body{
    margin:0;
    font-family:Inter,ui-sans-serif,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;
    background: radial-gradient(1200px 600px at 10% 10%, rgba(214,169,74,0.06), transparent 10%),
                radial-gradient(1000px 400px at 90% 90%, rgba(246,200,95,0.06), transparent 10%),
                linear-gradient(180deg,#020203 0%, #09070a 40%, #0d0b0f 100%);
    color: #e7e4dd;
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    overflow-y:auto;
  }

  /* subtle animated shimmer overlay */
  .shimmer {
    position:fixed; inset:0; pointer-events:none; mix-blend-mode:overlay;
    background: linear-gradient(90deg, rgba(0,0,0,0), rgba(246,200,95,0.03), rgba(0,0,0,0));
    animation: shimmer 12s linear infinite;
  }
  @keyframes shimmer { 0%{transform:translateX(-100%)} 100%{transform:translateX(100%)} }

  /* Container */
  .container{ max-width:1200px; margin:28px auto; padding:20px; }

  /* Header */
  header {
    display:flex; align-items:center; gap:14px;
    padding:18px 22px; border-radius:12px;
    background: linear-gradient(90deg, rgba(246,200,95,0.06), rgba(212,169,74,0.03));
    backdrop-filter: blur(6px);
    box-shadow: 0 6px 30px rgba(0,0,0,0.6), 0 1px 0 rgba(246,200,95,0.04) inset;
  }
  .brand {
    width:56px; height:56px; border-radius:12px;
    background:linear-gradient(180deg,var(--gold) 0%, var(--gold-deep) 100%);
    display:flex; align-items:center; justify-content:center; color:#111; font-weight:700;
    font-size:20px; box-shadow: 0 6px 18px rgba(214,169,74,0.25);
  }
  .brand h1{margin:0; font-size:20px; letter-spacing:0.6px}
  .brand p{margin:0; font-size:12px; color:#efe7d0}

  /* Layout */
  .top-row{ display:flex; gap:16px; margin-top:18px; flex-wrap:wrap; align-items:flex-start; }
  .left-col{ flex:1 1 420px; min-width:320px; }
  .right-col{ width:360px; min-width:280px; }

  /* Card style (glass + neon edge) */
  .card {
    background: var(--card-bg);
    border-radius:14px;
    padding:18px;
    box-shadow: 0 8px 30px rgba(2,2,2,0.6);
    border: 1px solid rgba(214,169,74,0.06);
    transition: transform .18s ease, box-shadow .18s ease, border-color .18s ease;
  }
  .card .title { font-weight:600; color: #f3ead2; display:flex; align-items:center; gap:10px; }
  .card:hover{ transform: translateY(-6px); border-color: rgba(246,200,95,0.22); box-shadow: 0 18px 60px rgba(214,169,74,0.06); }

  /* Tools layout */
  .categories-grid {
    display:grid; gap:16px;
    grid-template-columns: repeat(1,1fr);
  }
  @media(min-width:900px){ .categories-grid{ grid-template-columns: repeat(2,1fr);} }
  @media(min-width:1200px){ .categories-grid{ grid-template-columns: repeat(3,1fr);} }

  .category-card {
    background: linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.015));
    border-radius:12px;
    padding:16px;
    transition: box-shadow .18s ease, transform .18s ease;
    border:1px solid rgba(255,255,255,0.02);
  }
  .category-header{ display:flex; align-items:center; gap:12px; margin-bottom:10px; }
  .category-icon { font-size:28px; width:44px; height:44px; border-radius:8px; display:flex; align-items:center; justify-content:center; background:linear-gradient(180deg, rgba(246,200,95,0.12), rgba(214,169,74,0.06)); color:var(--gold); box-shadow: 0 4px 18px rgba(214,169,74,0.06); }
  .category-name{ font-weight:700; color:#f8f5eb; font-size:16px; }

  /* tool list */
  ul.tools { list-style:none; margin:0; padding:0; display:flex; flex-direction:column; gap:8px; }
  ul.tools li {
    padding:10px 12px; border-radius:10px; cursor:pointer;
    display:flex; justify-content:space-between; align-items:center;
    background:transparent; color:#e7e4dd;
    transition: transform .12s ease, box-shadow .12s ease, background .12s ease;
    border: 1px solid transparent;
  }
  ul.tools li .tool-left { display:flex; gap:10px; align-items:center; }
  ul.tools li .tool-dot { width:10px; height:10px; border-radius:4px; background:rgba(255,255,255,0.04); }
  ul.tools li:hover{ transform: translateY(-3px); box-shadow: 0 8px 28px rgba(214,169,74,0.06); border-color: rgba(246,200,95,0.08); }
  ul.tools li.selected {
    background: linear-gradient(90deg, rgba(246,200,95,0.08), rgba(214,169,74,0.03));
    border-color: rgba(246,200,95,0.18);
    box-shadow: 0 12px 40px rgba(214,169,74,0.08);
    transform: translateY(-4px) scale(1.01);
  }
  ul.tools li .coming { font-size:12px; color:#f3ead2; opacity:0.8; }

  /* Auth card */
  .auth-card { width:100%; max-width:420px; margin:0 auto; }
  .auth-card input { width:100%; padding:12px; border-radius:10px; border:1px solid rgba(255,255,255,0.04); background:rgba(0,0,0,0.25); color:#fff; margin-bottom:10px; outline:none; }
  .auth-btn {
    width:100%; padding:12px; border-radius:10px; background:linear-gradient(90deg,var(--gold),var(--gold-deep));
    color:#111; font-weight:600; border:none; cursor:pointer; box-shadow: 0 8px 24px rgba(214,169,74,0.12);
  }
  .google-btn {
    width:100%; padding:10px; border-radius:10px; border:1px solid rgba(246,200,95,0.14); background:transparent;
    color:var(--gold); font-weight:600; display:flex; align-items:center; gap:10px; justify-content:center;
  }
  .divider { display:flex; align-items:center; gap:12px; margin:12px 0; color:#bfb6a1; font-size:13px; opacity:0.9; }
  .divider::before, .divider::after { content:""; flex:1; height:1px; background: linear-gradient(90deg, transparent, rgba(214,169,74,0.08)); }

  /* Toast */
  .toast { position:fixed; right:18px; bottom:18px; background:rgba(14,14,14,0.9); color:#fff; padding:10px 14px; border-radius:10px; box-shadow: 0 6px 24px rgba(0,0,0,0.6); z-index:9999; border-left:4px solid var(--gold); }

  /* footer */
  footer { text-align:center; color:#cfc7ad; margin-top:30px; font-size:13px; }

</style>
</head>
<body>
  <div class="shimmer" aria-hidden="true"></div>

  <div class="container">
    <!-- Header -->
    <header class="card">
      <div class="brand" aria-hidden="true">TN</div>
      <div>
        <h1 style="margin:0">ToolNest</h1>
        <p style="margin:0; font-size:13px; color:#e7dcc0">All business tools â€” premium suite</p>
      </div>

      <div style="margin-left:auto; display:flex; gap:10px; align-items:center;">
        <button id="logoutBtn" class="auth-btn" style="background:transparent; color:var(--gold); border:1px solid rgba(246,200,95,0.12); display:none">Logout</button>
      </div>
    </header>

    <div class="top-row">
      <!-- Left: Categories -->
      <div class="left-col">
        <section class="card">
          <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:10px">
            <div>
              <div style="font-size:13px; color:#d8caa3">Welcome back</div>
              <div style="font-size:20px; font-weight:700">Dashboard</div>
            </div>
            <div style="text-align:right; color:#d8caa3; font-size:13px">Premium free for now â€” coming soon upgrades</div>
          </div>

          <div class="categories-grid" id="categoriesGrid">
            <!-- categories will be injected here -->
          </div>
        </section>
      </div>

      <!-- Right: Auth / Info -->
      <aside class="right-col">
        <section class="card auth-card">
          <div style="font-weight:700; margin-bottom:10px">Account</div>

          <div id="authFormArea">
            <input id="email" type="email" placeholder="Email" />
            <input id="password" type="password" placeholder="Password" />
            <input id="mobile" type="tel" placeholder="Mobile number (e.g. +92300...)" />
            <button id="submitAuth" class="auth-btn">Continue</button>

            <div class="divider">or continue with</div>
            <button id="googleBtn" class="google-btn">
              <svg width="18" height="18" viewBox="0 0 533.5 544.3" xmlns="http://www.w3.org/2000/svg"><path fill="#4285f4" d="M533.5 278.4c0-17.9-1.6-35.2-4.6-52H272v98.6h146.9c-6.3 34.1-25 63-53.4 82.2v68.3h86.1c50.3-46.4 81.9-114.9 81.9-197.1z"/><path fill="#34a853" d="M272 544.3c72.5 0 133.4-24.1 177.9-65.5l-86.1-68.3c-24 16.1-54.9 25.6-91.8 25.6-70.6 0-130.3-47.6-151.6-111.5H33.2v69.8C77.3 493.2 170.8 544.3 272 544.3z"/><path fill="#fbbc05" d="M120.4 323.1c-5.5-16.6-8.6-34.3-8.6-52.4s3.1-35.9 8.6-52.4V148.5H33.2C12 192.5 0 238.3 0 268.7s12 76.2 33.2 120.2l87.2-65.8z"/><path fill="#ea4335" d="M272 107.7c39.5 0 75 13.6 102.8 40.4l77.1-77.1C397.2 24.4 335.5 0 272 0 170.8 0 77.3 51.1 33.2 148.5l87.2 69.8C141.7 155.3 201.4 107.7 272 107.7z"/></svg>
              Continue with Google
            </button>

            <p style="margin-top:10px; font-size:13px; color:#cfc49e">
              <a id="toggleAuthText" style="color:var(--gold); cursor:pointer">Create an account</a> â€¢ <a id="forgotPass" style="color:#e7dcc0; cursor:pointer">Forgot Password?</a>
            </p>
          </div>

        </section>

        <section class="card" style="margin-top:16px">
          <div style="font-weight:700; margin-bottom:8px">Quick Tips</div>
          <ul style="margin:0; padding-left:18px; color:#cfc49e">
            <li>Click a tool once to highlight, again to open.</li>
            <li>Popular calculators: ROI, Profit Margin, Break-even, Loan EMI.</li>
            <li>Mobile number stored securely (Firestore).</li>
          </ul>
        </section>

      </aside>
    </div>

    <footer>Â© <strong>ToolNest</strong> â€” Premium tools, globally. </footer>
  </div>

  <!-- Toast container (JS will create toasts here) -->
  <div id="toasts"></div>

<script type="module">
/* =========================
   Firebase + App logic
   ========================= */
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
import {
  getAuth,
  createUserWithEmailAndPassword,
  signInWithEmailAndPassword,
  signOut,
  sendPasswordResetEmail,
  GoogleAuthProvider,
  signInWithPopup,
  updateProfile,
  onAuthStateChanged
} from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";
import { getFirestore, doc, setDoc } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

// ---------- your firebase config ----------
const firebaseConfig = {
  apiKey: "AIzaSyBuYXfr-_q-BJskWHN4chB8SZqMc-P9odw",
  authDomain: "toolnest-8e42d.firebaseapp.com",
  projectId: "toolnest-8e42d",
  storageBucket: "toolnest-8e42d.firebasestorage.app",
  messagingSenderId: "988256036107",
  appId: "1:988256036107:web:90f7e40f07593dff8e2e0e"
};
// ------------------------------------------
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

// UI refs
const submitAuthBtn = document.getElementById('submitAuth');
const googleBtn = document.getElementById('googleBtn');
const toggleAuthText = document.getElementById('toggleAuthText');
const forgotPass = document.getElementById('forgotPass');
const logoutBtn = document.getElementById('logoutBtn');

const emailInput = document.getElementById('email');
const passInput = document.getElementById('password');
const mobileInput = document.getElementById('mobile');

let isSignup = false;

/* ---------- helpers: toasts ---------- */
function toast(msg, type='info'){
  const t = document.createElement('div');
  t.className = 'toast';
  t.innerText = msg;
  document.body.appendChild(t);
  setTimeout(()=>{ t.style.opacity='0'; t.addEventListener('transitionend',()=>t.remove()) }, 3200);
}

/* ---------- Auth flows ---------- */
toggleAuthText.addEventListener('click', ()=> {
  isSignup = !isSignup;
  toggleAuthText.innerText = isSignup ? 'Already have an account?' : 'Create an account';
  submitAuthBtn.innerText = isSignup ? 'Sign Up' : 'Continue';
});

submitAuthBtn.addEventListener('click', async ()=>{
  const email = emailInput.value.trim();
  const password = passInput.value;
  const mobile = mobileInput.value.trim();

  if(!email || !password) { toast('Please fill email and password','error'); return; }

  try {
    if(isSignup){
      const userCred = await createUserWithEmailAndPassword(auth, email, password);
      const uid = userCred.user.uid;

      // update displayName with mobile if no displayName
      try{
        await updateProfile(userCred.user, { displayName: mobile || null });
      }catch(e){ /* ignore if fails */ }

      // Save mobile to Firestore (better than forcing phoneNumber in Auth)
      if(mobile){
        await setDoc(doc(db, 'users', uid), { email, mobile, createdAt: new Date().toISOString() }, { merge:true });
      }

      toast('Account created successfully!');
    } else {
      await signInWithEmailAndPassword(auth, email, password);
      toast('Login successful!');
    }
    // clear sensitive
    passInput.value = '';
  } catch(err){
    console.error(err);
    toast(err.message || 'Auth error','error');
  }
});

/* Google sign-in */
googleBtn.addEventListener('click', async ()=>{
  try {
    const provider = new GoogleAuthProvider();
    const res = await signInWithPopup(auth, provider);
    const user = res.user;
    // store mobile if user supplied in input during google flow
    const mobile = mobileInput.value.trim();
    if(mobile){
      await setDoc(doc(db, 'users', user.uid), { email: user.email, mobile, provider:'google', updatedAt: new Date().toISOString() }, { merge:true });
      // optionally update displayName
      try { await updateProfile(user, { displayName: mobile }); } catch(e){}
    }
    toast('Signed in with Google!');
  } catch(e){
    console.error(e);
    toast(e.message || 'Google sign-in failed','error');
  }
});

/* forgot password */
forgotPass.addEventListener('click', async ()=>{
  const email = emailInput.value.trim();
  if(!email){ toast('Enter your email first','error'); return; }
  try {
    await sendPasswordResetEmail(auth, email);
    toast('Password reset email sent!');
  } catch(e){
    toast(e.message || 'Reset failed','error');
  }
});

/* logout */
logoutBtn.addEventListener('click', async ()=>{
  try {
    await signOut(auth);
    toast('Logged out');
  } catch(e){ toast('Logout failed','error') }
});

/* auth state to show/hide dashboard */
onAuthStateChanged(auth, user=>{
  const dashboard = document.getElementById('categoriesGrid');
  if(user){
    // show logout
    logoutBtn.style.display = 'inline-block';
    // hide auth card inputs visually (we keep them so Google flows still work)
    document.querySelector('.auth-card').style.opacity = '0.85';
    renderDashboard(); // show categories
    toast(`Welcome ${user.displayName || user.email}`);
  } else {
    logoutBtn.style.display = 'none';
    // hide categories (they are still present but we rely on the modal nature)
    document.querySelectorAll('.category-card').forEach(n=>n.remove());
  }
});

/* =========================
   Tools & Categories Data
   (same list you approved)
   ========================= */
const categories = [
  {
    name: "Finance & Accounting",
    icon: "ðŸ’°",
    tools: ["ROI Calculator","Profit Margin Calculator","Break-even Analyzer","Loan EMI Calculator","Tax / GST / VAT Calculator","Currency Converter","Expense Tracker","Cash Flow Analyzer","Salary / Payroll Sheet"]
  },
  {
    name: "Business Management",
    icon: "ðŸ“Š",
    tools: ["Revenue Forecast Tool","Budget Planner","Employee Attendance Tracker","Invoice Generator","Business Proposal Template","Time Tracking Tool","Meeting Notes Template"]
  },
  {
    name: "E-commerce & Marketing",
    icon: "ðŸ›’",
    tools: ["Product Pricing Calculator","Discount Finder","Inventory Tracker","MarketNest Analyzer","Competitor Tracker","Profit & Fee Calculator","Product Launch Planner"]
  },
  {
    name: "Data & Productivity",
    icon: "ðŸ“ˆ",
    tools: ["Google Sheets Templates","Excel Business Templates","CSV â†’ Excel Converter","Sheet Merger Tool","Data Cleaner","Dashboard Template"]
  },
  {
    name: "AI & Automation",
    icon: "ðŸ¤–",
    tools: ["ChatGPT Assistant","Gemini UI","Auto Email Generator","Task Automation Templates","AI Name / Slogan Generator","Document Summarizer"]
  },
  {
    name: "Design & Branding",
    icon: "ðŸŽ¨",
    tools: ["Logo Maker","Business Card Template","Brand Color Palette Generator","Social Media Post Caption Generator"]
  },
  {
    name: "Website & SEO",
    icon: "ðŸŒ",
    tools: ["Meta Tag Generator","SEO Keyword Density Checker","Backlink Tracker","Sitemap XML Generator","Page Speed Tester"]
  },
  {
    name: "Communication & Management",
    icon: "ðŸ’¬",
    tools: ["Project Task Manager","Team Chat UI","Client Feedback Form","Email Signature Generator"]
  },
  {
    name: "Premium Tools",
    icon: "ðŸš€",
    tools: ["MarketNest Pro Analyzer","Business Intelligence Dashboard","AI Data Visualizer","Multi-user Team Workspace"]
  }
];

/* render categories */
function renderDashboard(){
  const grid = document.getElementById('categoriesGrid');
  grid.innerHTML = '';
  categories.forEach(cat=>{
    const card = document.createElement('div');
    card.className = 'category-card';
    const header = document.createElement('div');
    header.className = 'category-header';
    const icon = document.createElement('div');
    icon.className = 'category-icon';
    icon.innerText = cat.icon;
    const title = document.createElement('div');
    title.className = 'category-name';
    title.innerText = cat.name;
    header.append(icon, title);
    card.appendChild(header);

    const list = document.createElement('ul');
    list.className = 'tools';
    cat.tools.forEach(tool=>{
      const li = document.createElement('li');
      li.tabIndex = 0;
      li.dataset.tool = tool;
      li.innerHTML = `<div class="tool-left"><div class="tool-dot"></div><div>${tool}</div></div><div class="coming">Open</div>`;
      list.appendChild(li);
    });
    card.appendChild(list);
    grid.appendChild(card);
  });
}

/* ===== Two-step click behavior:
   1) first click -> highlight selected (only one per entire dashboard)
   2) second click on same item -> open the appropriate page (if available) or show coming soon
*/
let currentlySelected = null;
document.addEventListener('click', (e)=>{
  const li = e.target.closest('li[data-tool]');
  if(!li) return;
  const toolName = li.dataset.tool;

  // if click on a different tool, select it
  if(currentlySelected !== li){
    if(currentlySelected) currentlySelected.classList.remove('selected');
    li.classList.add('selected');
    currentlySelected = li;
    return; // don't open yet
  }

  // same item clicked again -> open or show coming soon
  // mapping to file names we have/expect
  const map = {
    "ROI Calculator": "roi-calculator.html",
    "Profit Margin Calculator": "profit-margin-calculator.html",
    "Break-even Analyzer": "break-even-analyzer.html",
    "Loan EMI Calculator": "loan-emi-calculator.html",
    // other calculators can be added here
    "Tax / GST / VAT Calculator": null,
    "Currency Converter": null,
    "Expense Tracker": null,
    "Cash Flow Analyzer": null,
    "Salary / Payroll Sheet": null
  };

  const target = map[toolName];
  if(target){
    // open new tab (user wanted new windows earlier)
    window.open(target, '_blank');
  } else {
    toast(`${toolName} â€” coming soon!`);
  }
});

/* Accessibility: allow Enter on selected li to behave same as click */
document.addEventListener('keydown', (e)=>{
  if(e.key === 'Enter' && document.activeElement && document.activeElement.matches('li[data-tool]')){
    document.activeElement.click();
  }
});

/* Render initially (if logged in callback will also call it) */
renderDashboard();

/* expose toast to window for debug if needed */
window._tn_toast = toast;

</script>
</body>
</html>
