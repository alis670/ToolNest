<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ToolNest Dashboard</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>
@keyframes fadeIn {0%{opacity:0}100%{opacity:1}}
.animate-fadeIn {animation:fadeIn 0.5s ease-in;}
.category-btn {cursor:pointer;}
.tool-card:hover {transform: translateY(-5px); transition: all 0.3s;}
</style>
</head>
<body class="bg-gray-100 min-h-screen">

<!-- Logout Button -->
<button id="logoutBtn" class="fixed bottom-5 right-5 px-4 py-2 bg-red-500 text-white rounded-lg hidden z-50">Logout</button>

<!-- Toast Container -->
<div id="toastContainer" class="fixed top-5 right-5 z-50"></div>

<!-- Dashboard Container -->
<main class="max-w-7xl mx-auto p-6">
  <h1 class="text-3xl font-bold text-gray-700 mb-6">ToolNest Dashboard</h1>

  <!-- Category Buttons -->
  <div id="categoryContainer" class="flex flex-wrap gap-4 mb-6">
    <!-- Buttons added dynamically via JS -->
  </div>

  <!-- Tools Container -->
  <div id="toolsContainer" class="grid md:grid-cols-3 sm:grid-cols-2 grid-cols-1 gap-6">
    <!-- Tool cards added dynamically via JS -->
  </div>
</main>

<script type="module">
import { getAuth, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-auth.js";

// Firebase auth is assumed already initialized in your auth.js

const auth = getAuth();

// Toast function
function showToast(message, type="success"){
  const toastContainer = document.getElementById('toastContainer');
  const toast = document.createElement('div');
  toast.innerText = message;
  toast.className = `px-4 py-2 mb-2 rounded shadow-lg text-white ${type==="success"?"bg-green-500":"bg-red-500"} animate-fadeIn`;
  toastContainer.appendChild(toast);
  setTimeout(()=>toast.remove(),3000);
}

// Logout
const logoutBtn = document.getElementById('logoutBtn');
logoutBtn.onclick = async () => {
  await signOut(auth);
  showToast("Logged out successfully!");
}

// Categories & Tools Data
const categories = [
  {
    name: "Finance & Accounting",
    icon: "ðŸ’°",
    tools: [
      { name:"ROI Calculator", icon:"ðŸ“ˆ" },
      { name:"Profit Margin Calculator", icon:"ðŸ’¹" },
      { name:"Break-even Analyzer", icon:"âš–ï¸" },
      { name:"Loan EMI Calculator", icon:"ðŸ¦" },
      { name:"Tax/GST Calculator", icon:"ðŸ§¾" },
      { name:"Currency Converter", icon:"ðŸ’±" },
      { name:"Expense Tracker", icon:"ðŸ“" },
      { name:"Cash Flow Analyzer", icon:"ðŸ’µ" },
      { name:"Salary/Payroll Sheet", icon:"ðŸ‘·â€â™‚ï¸" }
    ]
  },
  {
    name: "Business Management",
    icon: "ðŸ“Š",
    tools: [
      { name:"Revenue Forecast Tool", icon:"ðŸ“ˆ" },
      { name:"Budget Planner", icon:"ðŸ’°" },
      { name:"Employee Attendance Tracker", icon:"ðŸ—“ï¸" },
      { name:"Invoice Generator", icon:"ðŸ§¾" },
      { name:"Business Proposal Template", icon:"ðŸ“„" },
      { name:"Time Tracking Tool", icon:"â±ï¸" },
      { name:"Meeting Notes Template", icon:"ðŸ“" }
    ]
  },
  {
    name: "E-commerce & Marketing",
    icon: "ðŸ›’",
    tools: [
      { name:"Product Pricing Calculator", icon:"ðŸ’²" },
      { name:"Discount Finder", icon:"ðŸ·ï¸" },
      { name:"Inventory Tracker", icon:"ðŸ“¦" },
      { name:"Keyword Research Tool", icon:"ðŸ”‘" },
      { name:"Competitor Tracker", icon:"ðŸ•µï¸â€â™‚ï¸" },
      { name:"Profit & Fee Calculator", icon:"ðŸ’¹" },
      { name:"Product Launch Planner", icon:"ðŸš€" }
    ]
  },
  {
    name: "Data & Productivity",
    icon: "ðŸ“‘",
    tools: [
      { name:"Google Sheets Templates", icon:"ðŸ“Š" },
      { name:"Excel Templates", icon:"ðŸ“ˆ" },
      { name:"CSV â†’ Excel Converter", icon:"ðŸ”„" },
      { name:"Sheet Merger Tool", icon:"ðŸ§©" },
      { name:"Data Cleaner", icon:"ðŸ§¹" },
      { name:"Dashboard Template", icon:"ðŸ“‰" }
    ]
  },
  {
    name: "AI & Automation",
    icon: "ðŸ¤–",
    tools: [
      { name:"ChatGPT Assistant", icon:"ðŸ’¬" },
      { name:"Gemini UI", icon:"ðŸª" },
      { name:"Auto Email Generator", icon:"âœ‰ï¸" },
      { name:"Task Automation Templates", icon:"âš¡" },
      { name:"AI Name/Slogan Generator", icon:"ðŸ–Šï¸" },
      { name:"Document Summarizer", icon:"ðŸ“„" }
    ]
  }
];

// Render category buttons
const categoryContainer = document.getElementById('categoryContainer');
const toolsContainer = document.getElementById('toolsContainer');

function renderCategoryButtons(){
  // Add "All" button
  const allBtn = document.createElement('div');
  allBtn.innerText = "All";
  allBtn.className = "category-btn px-4 py-2 bg-blue-600 text-white rounded-lg shadow cursor-pointer hover:bg-blue-700";
  allBtn.onclick = ()=>renderTools("All");
  categoryContainer.appendChild(allBtn);

  categories.forEach(cat=>{
    const btn = document.createElement('div');
    btn.innerText = `${cat.icon} ${cat.name}`;
    btn.className = "category-btn px-4 py-2 bg-gray-200 rounded-lg shadow hover:bg-gray-300";
    btn.onclick = ()=>renderTools(cat.name);
    categoryContainer.appendChild(btn);
  });
}

// Render tools cards
function renderTools(categoryName){
  toolsContainer.innerHTML = "";
  let filteredTools = [];

  if(categoryName==="All"){
    categories.forEach(cat=>filteredTools.push(...cat.tools.map(tool=>({...tool, category: cat.name}))));
  }else{
    const cat = categories.find(c=>c.name===categoryName);
    if(cat) filteredTools = cat.tools.map(tool=>({...tool, category: cat.name}));
  }

  filteredTools.forEach(tool=>{
    const card = document.createElement('div');
    card.className = "tool-card bg-white p-4 rounded-xl shadow hover:shadow-lg flex items-center gap-3";
    card.innerHTML = `<span class="text-2xl">${tool.icon}</span><div><h3 class="font-semibold">${tool.name}</h3><p class="text-gray-500 text-sm">${tool.category}</p></div>`;
    toolsContainer.appendChild(card);
  });
}

// Initialize
renderCategoryButtons();
renderTools("All");

// Firebase auth listener
onAuthStateChanged(auth, user=>{
  if(user){
    document.querySelector('main').classList.remove('hidden');
    logoutBtn.classList.remove('hidden');
  }else{
    document.querySelector('main').classList.add('hidden');
    logoutBtn.classList.add('hidden');
    window.location.href = "/index.html"; // redirect to login
  }
});
</script>

</body>
</html>
