<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HR Salary System</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="currencies.js"></script> <!-- Make sure currencies.js is in same folder -->
<style>
body{background:#f8f9fa;font-family:Arial;}
.card{padding:20px;margin-bottom:20px;}
.table th,.table td{vertical-align:middle !important;}
.cal-day{cursor:pointer;}
.modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.5);align-items:center;justify-content:center;}
.modal-dialog{max-width:400px;margin:auto;}
.modal-content{padding:20px;background:#fff;border-radius:5px;}
</style>
</head>
<body class="container mt-3">

<!DOCTYPE html>  <html lang="en">  
<head>  
<meta charset="UTF-8">  
<meta name="viewport" content="width=device-width, initial-scale=1.0">  
<title>HR Login/Signup Test</title>  
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">  
</head>  
<body class="container mt-5">  <div id="loginDiv" class="card p-4">  
<h2>HR Login / Sign Up</h2>  
<div class="mb-3">  
<button id="showLogin" class="btn btn-primary btn-sm">Login</button>  
<button id="showSignup" class="btn btn-secondary btn-sm">Sign Up</button>  
</div>  <form id="loginForm" style="display:block;">  
<input type="text" id="hrUserLogin" class="form-control mb-2" placeholder="Username" required>  
<input type="password" id="hrPassLogin" class="form-control mb-2" placeholder="Password" required>  
<button type="submit" class="btn btn-primary">Login</button>  
</form>  <form id="signupForm" style="display:none;">  
<input type="text" id="hrUserSignup" class="form-control mb-2" placeholder="Choose Username" required>  
<input type="password" id="hrPassSignup" class="form-control mb-2" placeholder="Choose Password" required>  
<button type="submit" class="btn btn-success">Sign Up</button>  
</form>  
</div>  <div id="mainApp" style="display:none;" class="mt-3">  
<h2>HR Dashboard</h2>  
<button id="logoutBtn" class="btn btn-danger mb-3">Logout</button>  
<p>Welcome to HR Dashboard!</p>  
</div>  <script>  
document.addEventListener('DOMContentLoaded', () => {  
  const loginDiv = document.getElementById('loginDiv');  
  const loginForm = document.getElementById('loginForm');  
  const signupForm = document.getElementById('signupForm');  
  const showLoginBtn = document.getElementById('showLogin');  
  const showSignupBtn = document.getElementById('showSignup');  
  const mainApp = document.getElementById('mainApp');  
  const logoutBtn = document.getElementById('logoutBtn');  
  
  // Toggle login/signup forms  
  showLoginBtn.addEventListener('click', () => {  
    loginForm.style.display = 'block';  
    signupForm.style.display = 'none';  
  });  
  showSignupBtn.addEventListener('click', () => {  
    loginForm.style.display = 'none';  
    signupForm.style.display = 'block';  
  });  
  
  // Auto-login if already logged in  
  if(localStorage.getItem('isLoggedIn') === 'true'){  
    loginDiv.style.display = 'none';  
    mainApp.style.display = 'block';  
  }  
  
  // Sign Up  
  signupForm.addEventListener('submit', e => {  
    e.preventDefault();  
    const user = document.getElementById('hrUserSignup').value.trim();  
    const pass = document.getElementById('hrPassSignup').value.trim();  
    if(!user || !pass){ alert('Enter username/password'); return; }  
    localStorage.setItem('hrUser', user);  
    localStorage.setItem('hrPass', pass);  
    alert('Account created! Please login.');  
    signupForm.reset();  
    loginForm.style.display = 'block';  
    signupForm.style.display = 'none';  
  });  
  
  // Login  
  loginForm.addEventListener('submit', e => {  
    e.preventDefault();  
    const user = document.getElementById('hrUserLogin').value.trim();  
    const pass = document.getElementById('hrPassLogin').value.trim();  
    const storedUser = localStorage.getItem('hrUser');  
    const storedPass = localStorage.getItem('hrPass');  
  
    if(user === storedUser && pass === storedPass){  
      localStorage.setItem('isLoggedIn', 'true');  
      loginDiv.style.display = 'none';  
      mainApp.style.display = 'block';  
    } else {  
      alert('Invalid credentials!');  
    }  
  });  
  
  // Logout  
  logoutBtn.addEventListener('click', () => {  
    localStorage.removeItem('isLoggedIn');  
    loginDiv.style.display = 'block';  
    mainApp.style.display = 'none';  
  });  
});  
</script>  

<!-- MAIN DASHBOARD -->
<div id="mainApp" style="display:none;">
<h2 class="mb-3">HR Dashboard</h2>
<button id="logoutBtn" class="btn btn-danger mb-3">Logout</button>

<!-- ADD EMPLOYEE -->
<div class="card">
<h4>Add Employee</h4>
<form id="addEmployeeForm" class="mb-3">
<div class="row">
<div class="col-md-2 mb-2"><input type="text" id="empName" placeholder="Name" class="form-control" required></div>
<div class="col-md-2 mb-2"><input type="text" id="empDept" placeholder="Department" class="form-control" required></div>
<div class="col-md-2 mb-2"><input type="text" id="empDesig" placeholder="Designation" class="form-control" required></div>
<div class="col-md-2 mb-2"><input type="number" id="empSalary" placeholder="Basic Salary" class="form-control" required></div>
<div class="col-md-2 mb-2">
<select id="empCurrency" class="form-select" required>
<option value="">Select Currency</option>
</select>
</div>
</div>
<button type="submit" class="btn btn-primary">Add Employee</button>
</form>

<h4>Employee List</h4>
<table class="table table-bordered" id="employeeTable">
<tr><th>Name</th><th>Dept</th><th>Designation</th><th>Salary</th><th>Currency</th><th>Action</th></tr>
</table>
</div>

<!-- ATTENDANCE -->
<div class="card">
<h4>Attendance Calendar</h4>
<div class="row mb-2">
<div class="col-md-3">
<input type="month" id="attendanceMonth" class="form-control">
</div>
</div>
<div id="calendar" class="table-responsive"></div>
</div>

<div class="card">
<h4>Attendance Records</h4>
<table class="table table-bordered" id="attendanceTable">
<tr><th>Date</th><th>Employee</th><th>Status</th><th>Late Minutes</th></tr>
</table>
</div>

<!-- SALARY CALCULATION -->
<div class="card">
<h4>Calculate Salary</h4>
<form id="calculateSalaryForm" class="mb-3">
<div class="row">
<div class="col-md-2 mb-2"><select id="salaryEmployee" class="form-select" required><option value="">Select Employee</option></select></div>
<div class="col-md-2 mb-2"><input type="date" id="startDate" class="form-control" required></div>
<div class="col-md-2 mb-2"><input type="date" id="endDate" class="form-control" required></div>
<div class="col-md-2 mb-2"><input type="number" step="0.1" id="overtimeHours" placeholder="Overtime Hours" class="form-control"></div>
<div class="col-md-2 mb-2"><input type="number" id="bonusAmount" placeholder="Bonus" class="form-control"></div>
<div class="col-md-2 mb-2"><button type="submit" class="btn btn-success w-100">Calculate Salary</button></div>
</div>
</form>

<h4>Salary List</h4>
<table class="table table-bordered" id="salaryTable">
<tr><th>Employee</th><th>Month</th><th>Net Salary</th><th>Payslip</th></tr>
</table>
</div>

<!-- ATTENDANCE CHART -->
<div class="card">
<h4>Attendance Chart</h4>
<canvas id="attendanceChart" height="100"></canvas>
</div>

<!-- ATTENDANCE MODAL -->
<div class="modal" id="attendanceModal">
<div class="modal-dialog">
<div class="modal-content">
<div class="modal-header">
<h5 class="modal-title">Mark Attendance</h5>
<button type="button" class="btn-close" onclick="closeModal()"></button>
</div>
<div class="modal-body">
<select id="modalEmployee" class="form-select mb-2"></select>
<select id="modalStatus" class="form-select mb-2">
<option value="">Select Status</option>
<option value="Present">Present</option>
<option value="Absent">Absent</option>
<option value="Late">Late</option>
</select>
<input type="number" id="modalLateMinutes" class="form-control mb-2" placeholder="Late minutes">
<input type="hidden" id="modalDate">
<button class="btn btn-primary w-100" onclick="saveAttendance()">Save</button>
</div>
</div>
</div>
</div>

<script>
let employees=[], attendance=[], salaries=[];
let currencySymbols={};

// LOAD CURRENCIES
function loadCurrencies(){
  const select = document.getElementById('empCurrency');
  currencies.forEach(c=>{
    const option=document.createElement('option');
    option.value=c.code;
    option.text=`${c.code} (${c.symbol})`;
    select.appendChild(option);
    currencySymbols[c.code]=c.symbol;
  });
}

// LOGIN/SIGNUP
document.addEventListener('DOMContentLoaded', ()=>{
  loadCurrencies();
  const loginDiv = document.getElementById('loginDiv');
  const loginForm = document.getElementById('loginForm');
  const signupForm = document.getElementById('signupForm');
  const showLoginBtn = document.getElementById('showLogin');
  const showSignupBtn = document.getElementById('showSignup');
  const mainApp = document.getElementById('mainApp');
  const logoutBtn = document.getElementById('logoutBtn');

  showLoginBtn.addEventListener('click', ()=>{ loginForm.style.display='block'; signupForm.style.display='none'; });
  showSignupBtn.addEventListener('click', ()=>{ loginForm.style.display='none'; signupForm.style.display='block'; });

  if(localStorage.getItem('isLoggedIn')==='true'){
    loginDiv.style.display='none'; mainApp.style.display='block';
    loadDataFromStorage();
  }

  signupForm.addEventListener('submit', e=>{
    e.preventDefault();
    const user=document.getElementById('hrUserSignup').value.trim();
    const pass=document.getElementById('hrPassSignup').value.trim();
    if(!user||!pass){ alert('Enter username/password'); return; }
    localStorage.setItem('hrUser', user);
    localStorage.setItem('hrPass', pass);
    alert('Account created! Please login.');
    signupForm.reset();
    loginForm.style.display='block';
    signupForm.style.display='none';
  });

  loginForm.addEventListener('submit', e=>{
    e.preventDefault();
    const user=document.getElementById('hrUserLogin').value.trim();
    const pass=document.getElementById('hrPassLogin').value.trim();
    const storedUser=localStorage.getItem('hrUser');
    const storedPass=localStorage.getItem('hrPass');
    if(user===storedUser && pass===storedPass){
      localStorage.setItem('isLoggedIn','true');
      loginDiv.style.display='none';
      mainApp.style.display='block';
      loadDataFromStorage();
    }else{ alert('Invalid credentials!'); }
  });

  logoutBtn.addEventListener('click', ()=>{
    localStorage.removeItem('isLoggedIn');
    loginDiv.style.display='block';
    mainApp.style.display='none';
  });

  // EMPLOYEE ADD/DELETE
  const addEmpForm=document.getElementById('addEmployeeForm');
  addEmpForm.addEventListener('submit', e=>{
    e.preventDefault();
    const emp={name:document.getElementById('empName').value,
               dept:document.getElementById('empDept').value,
               desig:document.getElementById('empDesig').value,
               salary:parseFloat(document.getElementById('empSalary').value),
               currency:document.getElementById('empCurrency').value};
    employees.push(emp); updateEmployeeTable(); updateEmployeeSelect(); saveDataToStorage(); addEmpForm.reset();
  });

  function updateEmployeeTable(){
    const table=document.getElementById('employeeTable');
    table.innerHTML="<tr><th>Name</th><th>Dept</th><th>Designation</th><th>Salary</th><th>Currency</th><th>Action</th></tr>";
    employees.forEach((e,i)=>{
      const row=table.insertRow();
      row.insertCell(0).innerText=e.name;
      row.insertCell(1).innerText=e.dept;
      row.insertCell(2).innerText=e.desig;
      row.insertCell(3).innerText=e.salary.toFixed(2);
      row.insertCell(4).innerText=e.currency;
      const btn=document.createElement('button');
      btn.className='btn btn-danger btn-sm';
      btn.innerText='Delete';
      btn.onclick=()=>{ employees.splice(i,1); updateEmployeeTable(); updateEmployeeSelect(); saveDataToStorage(); };
      row.insertCell(5).appendChild(btn);
    });
  }

  function updateEmployeeSelect(){
    const selects=[document.getElementById('modalEmployee'), document.getElementById('salaryEmployee')];
    selects.forEach(sel=>{
      sel.innerHTML='<option value="">Select Employee</option>';
      employees.forEach((e,i)=>{
        const opt=document.createElement('option'); opt.value=i; opt.text=e.name; sel.appendChild(opt);
      });
    });
  }

  function loadDataFromStorage(){
    employees=JSON.parse(localStorage.getItem('employees')||"[]");
    attendance=JSON.parse(localStorage.getItem('attendance')||"[]");
    salaries=JSON.parse(localStorage.getItem('salaries')||"[]");
    updateEmployeeTable(); updateEmployeeSelect();
  }

  function saveDataToStorage(){
    localStorage.setItem('employees', JSON.stringify(employees));
    localStorage.setItem('attendance', JSON.stringify(attendance));
    localStorage.setItem('salaries', JSON.stringify(salaries));
  }

});
</script>

</body>
</html>
