<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Employee Attendance Tracker</title>

<!-- jsPDF CDN for PDF export -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
:root{
  --bg:#f6f8fb; --card:#fff; --muted:#6b7280; --accent:#2563eb;
  --success:#10b981; --danger:#ef4444; --radius:10px;
  font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,Arial;
}
*{box-sizing:border-box;}
body{margin:0;background:var(--bg);color:#0f172a;padding:18px;}
.card{background:var(--card);border-radius:var(--radius);padding:16px;box-shadow:0 10px 30px rgba(2,6,23,0.06);}
h1,h2,h3,h4{margin:0;}
h2{font-size:20px;margin-bottom:12px;}
input,select,textarea,button{font-family:inherit;}
input,select,textarea{padding:8px;border-radius:8px;border:1px solid #e6eef8;background:#fff;width:100%;}
button{padding:8px 12px;border-radius:8px;border:0;cursor:pointer;font-weight:700;}
.btn.primary{background:var(--accent);color:#fff;}
.btn.ghost{background:#f1f5f9;border:1px solid #e6eef8;}
.table{overflow-x:auto;margin-top:12px;border-radius:8px;border:1px solid #eef2ff;}
table{width:100%;border-collapse:collapse;font-size:14px;}
th,td{padding:8px;border-bottom:1px solid #f1f5f9;text-align:left;min-width:100px;}
th{background:#fbfdff;position:sticky;top:0;}
.filter-row{display:grid;grid-template-columns:repeat(auto-fit,minmax(140px,1fr));gap:8px;align-items:end;margin-bottom:12px;}
@media (max-width:1000px){.filter-row{grid-template-columns:1fr 1fr;}}
.flex-end{display:flex;align-items:end;gap:8px;flex-wrap:wrap;}
</style>
</head>
<body>

<div class="card">
  <h2>Employee Attendance Tracker</h2>

  <!-- Filters -->
  <div class="filter-row">
    <div>
      <label>Month (YYYY-MM)</label>
      <input type="month" id="filterMonth">
    </div>
    <div>
      <label>Employee Name</label>
      <input type="text" id="filterEmployee" placeholder="Employee Name">
    </div>
    <div>
      <label>Department</label>
      <input type="text" id="filterDepartment" placeholder="Department">
    </div>
    <div>
      <button id="applyFilter" class="btn ghost" style="width:100%;">Apply Filter</button>
    </div>
  </div>

  <!-- Download buttons -->
  <div class="flex-end">
    <button id="exportCsv" class="btn ghost">Export CSV</button>
    <button id="exportJson" class="btn ghost">Export JSON</button>
    <button id="exportPdf" class="btn ghost">Export PDF</button>
  </div>

  <!-- Attendance Table -->
  <div class="table">
    <table>
      <thead>
        <tr>
          <th>Date</th>
          <th>Employee</th>
          <th>Department</th>
          <th>Status</th>
          <th>Notes</th>
        </tr>
      </thead>
      <tbody id="attendanceTbody">
        <!-- Dynamic rows go here -->
      </tbody>
    </table>
  </div>
</div>

<script>
let attendanceData = [
  {date:'2025-11-01',employee:'John Doe',department:'Sales',status:'Present',notes:''},
  {date:'2025-11-01',employee:'Jane Smith',department:'HR',status:'Absent',notes:''}
];

// Render table rows
function renderTable() {
  const tbody = document.getElementById('attendanceTbody');
  tbody.innerHTML = '';
  const filtered = getFiltered();
  filtered.forEach((a,index)=>{
    const tr = document.createElement('tr');
    tr.innerHTML = `
      <td><input type="date" value="${a.date}" onchange="updateRow(${index}, 'date', this.value)"></td>
      <td><input type="text" value="${a.employee}" onchange="updateRow(${index}, 'employee', this.value)"></td>
      <td><input type="text" value="${a.department}" onchange="updateRow(${index}, 'department', this.value)"></td>
      <td>
        <select onchange="updateRow(${index}, 'status', this.value)">
          <option ${a.status==='Present'?'selected':''}>Present</option>
          <option ${a.status==='Absent'?'selected':''}>Absent</option>
          <option ${a.status==='Late'?'selected':''}>Late</option>
        </select>
      </td>
      <td><input type="text" value="${a.notes}" onchange="updateRow(${index}, 'notes', this.value)"></td>
    `;
    tbody.appendChild(tr);
  });
}

// Update a row
function updateRow(index, field, value){
  const filtered = getFiltered();
  const item = filtered[index];
  if(item) item[field] = value;
}

// Filtered data
function getFiltered(){
  const month = document.getElementById('filterMonth').value;
  const emp = document.getElementById('filterEmployee').value.trim().toLowerCase();
  const dep = document.getElementById('filterDepartment').value.trim().toLowerCase();
  return attendanceData.filter(a=>{
    return (!month || a.date.startsWith(month)) &&
           (!emp || a.employee.toLowerCase().includes(emp)) &&
           (!dep || a.department.toLowerCase().includes(dep));
  });
}

document.getElementById('applyFilter').addEventListener('click', renderTable);

// --- Export CSV ---
document.getElementById('exportCsv').addEventListener('click', ()=>{
  const filtered = getFiltered();
  const csv = [
    ['Date','Employee','Department','Status','Notes'],
    ...filtered.map(a=>[a.date,a.employee,a.department,a.status,a.notes])
  ].map(r=>r.map(v=>`"${v}"`).join(',')).join('\n');
  const blob = new Blob([csv],{type:'text/csv'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a'); a.href=url; a.download='attendance.csv'; a.click();
  URL.revokeObjectURL(url);
});

// --- Export JSON ---
document.getElementById('exportJson').addEventListener('click', ()=>{
  const data = getFiltered();
  const blob = new Blob([JSON.stringify(data,null,2)],{type:'application/json'});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a'); a.href=url; a.download='attendance.json'; a.click();
  URL.revokeObjectURL(url);
});

// --- Export PDF ---
document.getElementById('exportPdf').addEventListener('click', ()=>{
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF();
  const data = getFiltered();
  doc.setFontSize(12);
  doc.text("Employee Attendance Tracker", 14, 14);
  let y=22;
  data.forEach(a=>{
    doc.text(`${a.date} | ${a.employee} | ${a.department} | ${a.status} | ${a.notes}`, 14, y);
    y+=8;
  });
  doc.save('attendance.pdf');
});

// Initial render
renderTable();
</script>

</body>
</html>
